"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getContractError = void 0;
const index_js_1 = require("../../errors/index.js");
const contract_js_1 = require("../../errors/contract.js");
const EXECUTION_REVERTED_ERROR_CODE = 3;
function getContractError(err, { abi, address, args, docsPath, functionName, sender, }) {
    const { code, data, message, shortMessage } = (err instanceof index_js_1.RawContractError
        ? err
        : !(err.cause && 'data' in err.cause) &&
            (err instanceof contract_js_1.CallExecutionError ||
                err instanceof index_js_1.EstimateGasExecutionError)
            ? err.cause?.cause?.cause || {}
            : err.cause || {});
    let cause = err;
    if (err instanceof index_js_1.AbiDecodingZeroDataError) {
        cause = new contract_js_1.ContractFunctionZeroDataError({ functionName });
    }
    else if (code === EXECUTION_REVERTED_ERROR_CODE &&
        (data || message || shortMessage)) {
        cause = new contract_js_1.ContractFunctionRevertedError({
            abi,
            data,
            functionName,
            message: shortMessage ?? message,
        });
    }
    return new index_js_1.ContractFunctionExecutionError(cause, {
        abi,
        args,
        contractAddress: address,
        docsPath,
        functionName,
        sender,
    });
}
exports.getContractError = getContractError;
//# sourceMappingURL=getContractError.js.map