{"version":3,"sources":["../src/index.ts","../src/diffReports.ts","../src/fetchIRStrategy.ts","../src/renderer/reserve.ts","../src/types.ts","../src/renderer/strategy.ts","../src/utils/diff.ts"],"sourcesContent":["export * from \"./diffReports\";\n","import hash from \"object-hash\";\nimport { fetchRateStrategyImage } from \"./fetchIRStrategy\";\nimport { renderReserve, renderReserveDiff } from \"./renderer/reserve\";\nimport { renderStrategy, renderStrategyDiff } from \"./renderer/strategy\";\nimport { AaveV3Snapshot, AaveV3Reserve } from \"./types\";\nimport { diff } from \"./utils/diff\";\n\nexport async function diffReports<\n  A extends AaveV3Snapshot,\n  B extends AaveV3Snapshot\n>(pre: A, post: B) {\n  const chainId = pre.chainId;\n  const diffResult = diff(pre, post);\n  // download interest rate strategies\n  // only downloads if it doesn't exist yet\n  for (const ir in pre.strategies) {\n    await fetchRateStrategyImage(pre.strategies[ir]);\n  }\n  for (const ir in post.strategies) {\n    await fetchRateStrategyImage(post.strategies[ir]);\n  }\n\n  // create report\n  let content = \"\";\n  const reservesAdded = Object.keys(diffResult.reserves)\n    .map((reserveKey) => {\n      // to being present on reserve level % trueish means reserve was added\n      if ((diffResult.reserves[reserveKey] as any).to) {\n        let report = renderReserve(\n          (diffResult.reserves[reserveKey] as any).to,\n          chainId\n        );\n        const imageHash = hash(\n          post.strategies[\n            ((diffResult.reserves[reserveKey] as any).to as AaveV3Reserve)\n              .interestRateStrategy\n          ]\n        );\n        report += renderStrategy(\n          post.strategies[\n            ((diffResult.reserves[reserveKey] as any).to as AaveV3Reserve)\n              .interestRateStrategy\n          ]\n        );\n\n        report += `| interestRate | ![ir](/.assets/${imageHash}.svg) |`;\n\n        return report;\n      }\n    })\n    .filter((i) => i);\n  const reservesRemoved = Object.keys(diffResult.reserves)\n    .map((reserveKey) => {\n      // from being present on reserve level % trueish means reserve was removed\n      if ((diffResult.reserves[reserveKey] as any).from) {\n        return renderReserve(\n          (diffResult.reserves[reserveKey] as any).from,\n          chainId\n        );\n      }\n    })\n    .filter((i) => i);\n  const reservesAltered = Object.keys(diffResult.reserves)\n    .map((reserveKey) => {\n      // from being present on key means reserve was removed\n      if (\n        !(diffResult.reserves[reserveKey] as any).hasOwnProperty(\"from\") &&\n        Object.keys(diffResult.reserves[reserveKey]).find(\n          (fieldKey) =>\n            typeof diffResult.reserves[reserveKey][fieldKey] === \"object\"\n        )\n      ) {\n        let report = renderReserveDiff(\n          diffResult.reserves[reserveKey] as any,\n          chainId\n        );\n        if (\n          diffResult.reserves[reserveKey].interestRateStrategy.hasOwnProperty(\n            \"from\"\n          )\n        ) {\n          report += renderStrategyDiff(\n            diff(\n              pre.strategies[\n                (diffResult.reserves[reserveKey].interestRateStrategy as any)\n                  .from\n              ],\n              post.strategies[\n                (diffResult.reserves[reserveKey].interestRateStrategy as any).to\n              ]\n            ) as any\n          );\n          report += `| interestRate | ![before](/.assets/${hash(\n            pre.strategies[\n              (diffResult.reserves[reserveKey].interestRateStrategy as any).from\n            ]\n          )}.svg) | ![after](/.assets/${hash(\n            post.strategies[\n              (diffResult.reserves[reserveKey].interestRateStrategy as any).to\n            ]\n          )}.svg) |`;\n        }\n\n        return report;\n      }\n    })\n    .filter((i) => i);\n  if (\n    reservesAdded.length ||\n    reservesRemoved.length ||\n    reservesAltered.length\n  ) {\n    content += \"## Reserve changes\\n\\n\";\n    if (reservesAdded.length) {\n      content += `### ${\n        reservesAdded.length > 1 ? \"Reserve\" : \"Reserves\"\n      } added\\n\\n`;\n      content += reservesAdded.join(\"\\n\\n\");\n      content += \"\\n\\n\";\n    }\n\n    if (reservesAltered.length) {\n      content += `### ${\n        reservesAltered.length > 1 ? \"Reserve\" : \"Reserves\"\n      } altered\\n\\n`;\n      content += reservesAltered.join(\"\\n\\n\");\n      content += \"\\n\\n\";\n    }\n\n    if (reservesRemoved.length) {\n      content += `### ${\n        reservesRemoved.length > 1 ? \"Reserve\" : \"Reserves\"\n      } removed\\n\\n`;\n      content += reservesRemoved.join(\"\\n\\n\");\n      content += \"\\n\\n\";\n    }\n  }\n\n  content += `## Raw diff\\n\\n\\`\\`\\`json\\n${JSON.stringify(\n    diff(pre, post, true),\n    null,\n    2\n  )}\\n\\`\\`\\``;\n  return content;\n}\n","import path from \"path\";\nimport { existsSync, mkdirSync, createWriteStream } from \"fs\";\nimport { pipeline } from \"stream\";\nimport { promisify } from \"util\";\nimport fetch from \"node-fetch\";\nimport hash from \"object-hash\";\n\nconst streamPipeline = promisify(pipeline);\n\n/**\n * Fetches the rate image from rate-strategy explorer\n * @dev currently broken as https://github.com/foundry-rs/foundry/issues/4601 results in json numbers which will be broken inside js\n * @param {*} rate\n * @param fileName the fileName to store the ir to\n */\nexport async function fetchRateStrategyImage(rate) {\n  const fileHash = hash(rate);\n  const relativePath = path.join(process.cwd(), \".assets\");\n  const pathWithFile = path.join(relativePath, `${fileHash}.svg`);\n  // skip in case file already exists\n  if (existsSync(pathWithFile)) return;\n  // create folder if it doesn't exist\n  if (!existsSync(relativePath)) {\n    mkdirSync(relativePath, { recursive: true });\n  }\n  const paramsObj = {\n    variableRateSlope1: rate.variableRateSlope1,\n    variableRateSlope2: rate.variableRateSlope2,\n    stableRateSlope1: rate.stableRateSlope1,\n    stableRateSlope2: rate.stableRateSlope2,\n    optimalUsageRatio: rate.optimalUsageRatio,\n    baseVariableBorrowRate: rate.baseVariableBorrowRate,\n    baseStableBorrowRate: rate.baseStableBorrowRate,\n  };\n  const searchParams = new URLSearchParams(paramsObj);\n  const { body } = await fetch(\n    `https://rate-strategy-explorer.vercel.app/api/static?${searchParams.toString()}`\n  );\n  if (!body) throw Error(\"Error fetchign the image\");\n  await streamPipeline(body, createWriteStream(pathWithFile));\n}\n","import { formatUnits } from \"viem\";\nimport { AaveV3Reserve, CHAIN_ID } from \"../types\";\n\nexport const getBlockExplorerLink: {\n  [key in CHAIN_ID]: (address: string) => string;\n} = {\n  [CHAIN_ID.MAINNET]: (address) =>\n    `[${address}](https://etherscan.io/address/${address})`,\n  [CHAIN_ID.OPTIMISM]: (address) =>\n    `[${address}](https://optimistic.etherscan.io/address/${address})`,\n  [CHAIN_ID.POLYGON]: (address) =>\n    `[${address}](https://polygonscan.com/address/${address})`,\n  [CHAIN_ID.FANTOM]: (address) =>\n    `[${address}](https://ftmscan.com/address/${address})`,\n  [CHAIN_ID.ARBITRUM]: (address) =>\n    `[${address}](https://https://arbiscan.io/address/${address})`,\n  [CHAIN_ID.AVALANCHE]: (address) =>\n    `[${address}](https://snowtrace.io/address/${address})`,\n};\n\nexport function renderReserveValue<T extends keyof AaveV3Reserve>(\n  key: T,\n  reserve: AaveV3Reserve,\n  chainId: CHAIN_ID\n) {\n  if (\n    [\n      \"reserveFactor\",\n      \"liquidationProtocolFee\",\n      \"liquidationThreshold\",\n      \"ltv\",\n    ].includes(key)\n  )\n    return `${(reserve[key] as number) / 100} %`;\n  if ([\"supplyCap\", \"borrowCap\"].includes(key))\n    return `${reserve[key].toLocaleString(\"en-US\")} ${reserve.symbol}`;\n  if (key === \"liquidationBonus\")\n    return `${((reserve[key] as number) - 10000) / 100} %`;\n  if (key === \"interestRateStrategy\")\n    return getBlockExplorerLink[chainId](reserve[key] as string);\n  if (key === \"oracleLatestAnswer\" && reserve.oracleDecimals)\n    return formatUnits(BigInt(reserve[key]), reserve.oracleDecimals);\n  if (typeof reserve[key] === \"number\")\n    return reserve[key].toLocaleString(\"en-US\");\n  if (typeof reserve[key] === \"string\" && /0x.+/.test(reserve[key] as string))\n    return getBlockExplorerLink[chainId](reserve[key] as string);\n  return reserve[key];\n}\n\nfunction renderReserveHeadline(reserve: AaveV3Reserve, chainId: CHAIN_ID) {\n  return `#### ${reserve.symbol} (${getBlockExplorerLink[chainId](\n    reserve.underlying\n  )})\\n\\n`;\n}\n\nconst ORDER: (keyof AaveV3Reserve)[] = [\n  \"supplyCap\",\n  \"borrowCap\",\n  \"oracle\",\n  \"oracleDecimals\",\n  \"oracleDescription\",\n  \"oracleName\",\n  \"oracleLatestAnswer\",\n];\nfunction sortReserveKeys(a: keyof AaveV3Reserve, b: keyof AaveV3Reserve) {\n  const indexA = ORDER.indexOf(a);\n  const indexB = ORDER.indexOf(b);\n  if (indexA != -1 && indexB != -1) {\n    if (indexA > indexB) {\n      return 1;\n    }\n    if (indexB > indexA) {\n      return -1;\n    }\n  }\n  if (indexA != -1) return -1;\n  if (indexB != -1) return -1;\n  return a.localeCompare(b);\n}\n\nfunction renderReserveConfig(reserve: AaveV3Reserve, chainId: CHAIN_ID) {\n  let content = \"| description | value |\\n| --- | --- |\\n\";\n  const OMIT_KEYS: (keyof AaveV3Reserve)[] = [\n    \"underlying\", // already rendered in the header\n    \"symbol\", // already rendered in the header\n  ];\n  (Object.keys(reserve) as (keyof AaveV3Reserve)[])\n    .filter((key) => !OMIT_KEYS.includes(key))\n    .sort(sortReserveKeys)\n    .map((key) => {\n      content += `| ${key} | ${renderReserveValue(key, reserve, chainId)} |\\n`;\n    });\n  return content;\n}\n\nexport function renderReserve(reserve: AaveV3Reserve, chainId: CHAIN_ID) {\n  let content = renderReserveHeadline(reserve, chainId);\n  content += renderReserveConfig(reserve, chainId);\n  return content;\n}\n\nexport type ReserveDiff<A extends AaveV3Reserve = AaveV3Reserve> = {\n  [key in keyof A]: A[key] & { from: A[key] | null; to: A[key] | null };\n};\n\nexport function renderReserveDiff(diff: ReserveDiff, chainId: CHAIN_ID) {\n  let content = renderReserveHeadline(diff as AaveV3Reserve, chainId);\n  content +=\n    \"| description | value before | value after |\\n| --- | --- | --- |\\n\";\n  (Object.keys(diff) as (keyof AaveV3Reserve)[])\n    .filter((key) => diff[key].hasOwnProperty(\"from\"))\n    .sort(sortReserveKeys)\n    .map((key) => {\n      content += `| ${key} | ${renderReserveValue(\n        key,\n        { ...diff, [key]: diff[key].from },\n        chainId\n      )} | ${renderReserveValue(\n        key,\n        { ...diff, [key]: diff[key].to },\n        chainId\n      )} |\\n`;\n    });\n  return content;\n}\n","import { z } from \"zod\";\n\nexport const aaveV3ConfigSchema = z.object({\n  oracle: z.string(),\n  pool: z.string(),\n  poolAddressesProvider: z.string(),\n  poolConfigurator: z.string(),\n  poolConfiguratorImpl: z.string(),\n  poolImpl: z.string(),\n  protocolDataProvider: z.string(),\n});\n\nexport type AaveV3Config = z.infer<typeof aaveV3ConfigSchema>;\n\nexport const aaveV3ReserveSchema = z.object({\n  isBorrowableInIsolation: z.boolean(),\n  borrowCap: z.number(),\n  liquidationBonus: z.number(),\n  underlying: z.string(),\n  isFrozen: z.boolean(),\n  stableDebtToken: z.string(),\n  variableDebtToken: z.string(),\n  reserveFactor: z.number(),\n  liquidationProtocolFee: z.number(),\n  usageAsCollateralEnabled: z.boolean(),\n  ltv: z.number(),\n  supplyCap: z.number(),\n  debtCeiling: z.number(),\n  borrowingEnabled: z.boolean(),\n  isActive: z.boolean(),\n  eModeCategory: z.number(),\n  symbol: z.string(),\n  stableBorrowRateEnabled: z.boolean(),\n  isFlashloanable: z.boolean(),\n  aToken: z.string(),\n  liquidationThreshold: z.number(),\n  aTokenImpl: z.string(),\n  stableDebtTokenImpl: z.string(),\n  interestRateStrategy: z.string(),\n  variableDebtTokenImpl: z.string(),\n  oracleLatestAnswer: z.number(),\n  oracle: z.string(),\n  oracleDecimals: z.number(),\n  oracleName: z.string(),\n  oracleDescription: z.string(),\n  decimals: z.number(),\n  isSiloed: z.boolean(),\n});\n\nexport type AaveV3Reserve = z.infer<typeof aaveV3ReserveSchema>;\n\nexport const aaveV3StrategySchema = z.object({\n  baseStableBorrowRate: z.string(),\n  maxExcessStableToTotalDebtRatio: z.string(),\n  address: z.string(),\n  baseVariableBorrowRate: z.string(),\n  stableRateSlope2: z.string(),\n  optimalUsageRatio: z.string(),\n  variableRateSlope2: z.string(),\n  optimalStableToTotalDebtRatio: z.string(),\n  maxExcessUsageRatio: z.string(),\n  stableRateSlope1: z.string(),\n  variableRateSlope1: z.string(),\n});\n\nexport type AaveV3Strategy = z.infer<typeof aaveV3StrategySchema>;\n\nexport const aaveV3EmodeSchema = z.object({\n  eModeCategory: z.number(),\n  liquidationBonus: z.number(),\n  label: z.string(),\n  liquidationThreshold: z.number(),\n  priceSource: z.string(),\n  ltv: z.number(),\n});\n\nexport type AaveV3Emode = z.infer<typeof aaveV3EmodeSchema>;\n\nexport const CHAIN_ID = {\n  MAINNET: 1,\n  OPTIMISM: 10,\n  POLYGON: 137,\n  FANTOM: 250,\n  ARBITRUM: 42161,\n  AVALANCHE: 43114,\n} as const;\n\nconst zodChainId = z.nativeEnum(CHAIN_ID);\n\nexport type CHAIN_ID = z.infer<typeof zodChainId>;\n\nexport const aaveV3SnapshotSchema = z.object({\n  reserves: z.record(aaveV3ReserveSchema),\n  strategies: z.record(aaveV3StrategySchema),\n  eModes: z.record(aaveV3EmodeSchema),\n  poolConfig: aaveV3ConfigSchema,\n  chainId: zodChainId,\n});\n\nexport type AaveV3Snapshot = z.infer<typeof aaveV3SnapshotSchema>;\n","import { AaveV3Strategy } from \"../types\";\nimport { formatUnits } from \"viem\";\n\nexport function renderStrategyValue<T extends keyof AaveV3Strategy>(\n  key: T,\n  reserve: AaveV3Strategy\n) {\n  return `${formatUnits(BigInt(reserve[key]), 25)} %`;\n}\n\nconst ORDER: (keyof AaveV3Strategy)[] = [\n  \"optimalUsageRatio\",\n  \"maxExcessUsageRatio\",\n  \"baseVariableBorrowRate\",\n  \"variableRateSlope1\",\n  \"variableRateSlope2\",\n  \"baseStableBorrowRate\",\n  \"stableRateSlope1\",\n  \"stableRateSlope2\",\n  \"optimalStableToTotalDebtRatio\",\n  \"maxExcessStableToTotalDebtRatio\",\n];\nfunction sortStrategyKeys(a: keyof AaveV3Strategy, b: keyof AaveV3Strategy) {\n  const indexA = ORDER.indexOf(a);\n  const indexB = ORDER.indexOf(b);\n  if (indexA != -1 && indexB != -1) {\n    if (indexA > indexB) {\n      return 1;\n    }\n    if (indexB > indexA) {\n      return -1;\n    }\n  }\n  if (indexA != -1) return -1;\n  if (indexB != -1) return -1;\n  return a.localeCompare(b);\n}\n\nconst OMIT_KEYS: (keyof AaveV3Strategy)[] = [\n  \"address\", // already rendered in the reserve\n];\n\nexport function renderStrategy(strategy: AaveV3Strategy) {\n  let content = \"\";\n  (Object.keys(strategy) as (keyof AaveV3Strategy)[])\n    .filter((key) => !OMIT_KEYS.includes(key))\n    .sort(sortStrategyKeys)\n    .map((key) => {\n      content += `| ${key} | ${renderStrategyValue(key, strategy)} |\\n`;\n    });\n  return content;\n}\n\nexport type StrategyDiff<A extends AaveV3Strategy = AaveV3Strategy> = {\n  [key in keyof AaveV3Strategy]: A[key] & {\n    from: A[key] | null;\n    to: A[key] | null;\n  };\n};\n\nexport function renderStrategyDiff(diff: StrategyDiff) {\n  let content = \"\";\n\n  (Object.keys(diff) as (keyof AaveV3Strategy)[])\n    .filter((key) => !OMIT_KEYS.includes(key))\n    .filter((key) => diff[key].hasOwnProperty(\"from\"))\n    .sort(sortStrategyKeys)\n    .map((key) => {\n      content += `| ${key} | ${renderStrategyValue(key, {\n        ...diff,\n        [key]: diff[key].from,\n      })} | ${renderStrategyValue(key, { ...diff, [key]: diff[key].to })} |\\n`;\n    });\n\n  return content;\n}\n","/**\n * Highly inspired by - reimplemented a bit simpler & added types\n * @license MIT https://github.com/omgaz/diffler\n * Author: Gary Chisholm @omgaz\n */\n\nexport type Difference<\n  A extends Record<string, any>,\n  B extends Record<string, any>\n> = { [key in keyof Omit<A, keyof B>]: { from: A[key]; to: null } } & {\n  [key in keyof Omit<B, keyof A>]: { from: null; to: B[key] };\n};\n\nexport type DiffOutput<\n  A extends Record<string, any>,\n  B extends Record<string, any>\n> = {\n  [key in keyof (A | B)]: DiffOutput<A[key], B[key]>;\n} & Difference<A, B>;\n\nexport function diff<\n  T extends Record<string, any>,\n  X extends Record<string, any>\n>(a: T, b: X, removeUnchanged?: boolean): DiffOutput<T, X> {\n  const out = {} as Record<string, any>;\n  for (const key in a) {\n    if (!b.hasOwnProperty(key)) {\n      out[key] = { from: a[key], to: null };\n    } else {\n      if (typeof a[key] === \"object\") {\n        const tempDiff = diff(a[key], b[key], removeUnchanged);\n        if (Object.keys(tempDiff).length > 0) {\n          out[key] = tempDiff;\n        }\n      } else {\n        if (b[key as string] == a[key]) {\n          if (!removeUnchanged) out[key] = a[key];\n        } else {\n          out[key] = { from: a[key], to: b[key] };\n        }\n      }\n    }\n  }\n  for (const key in b) {\n    if (a.hasOwnProperty(key)) continue;\n    out[key] = { from: null, to: b[key] };\n  }\n  return out as DiffOutput<T, X>;\n}\n"],"mappings":"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","names":["import_object_hash","hash","path","fetch","OMIT_KEYS","diff","import_viem","ORDER","diff","hash"]}